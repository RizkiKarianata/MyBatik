<template>
	<div class="page">
		<div class="navbar navbar-cart">
			<div class="navbar-inner">
				<div class="left"></div>
				<div class="title sliding title-heading"><a href="/home/"><h1>MyBatik</h1></a></div>
				<div class="right"></div>
			</div>
		</div>
		<div class="page-content">
			<div class="slide-shop">
				<div data-pagination='{"el": ".swiper-pagination", "hideOnClick": true}' class="swiper-container swiper-init demo-swiper">
					<div class="swiper-pagination"></div>
					<div class="swiper-wrapper">
						<div class="swiper-slide">
							<div class="slide-content">
								<div class="mask"></div>
								<img src="static/images/bg-slider-1.jpg" alt="">
								<div class="intro-caption">
									<h2>MyBatik</h2>
									<p>Selamat datang di Aplikasi MyBatik. Aplikasi yang berguna untuk mengetahui info tentang batik.</p>
								</div>
							</div>
						</div>
						<div class="swiper-slide">
							<div class="slide-content">
								<div class="mask"></div>
								<img src="static/images/bg-slider-2.jpg" alt="">
								<div class="intro-caption">
									<h2>Beragam Motif Menarik</h2>
									<p>Batik mempunyai berbagai macam motif menarik sesuai dengan daerahnya masing - masing.</p>
								</div>
							</div>
						</div>
						<div class="swiper-slide">
							<div class="slide-content">
								<div class="mask"></div>
								<img src="static/images/bg-slider-3.jpg" alt="">
								<div class="intro-caption">
									<h2>Kebudayaan</h2>
									<p>Batik merupakan warisan dari nenek moyang Indonesia yang merupakan kerajinan tangan.</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="product product-home popular-product segments">
				<div class="container">
					<div class="section-title">
						<h3>Batik Terpopuler</h3>
					</div>
					<div class="row">
						{{#each data1}}
						<div class="col-50">
							<div class="content">
								{{#if this.link_batik}}
								<img src="{{this.link_batik}}" alt="" referrerpolicy="no-referrer" style="max-height: 80px;">
								{{else}}
								<img src="static/images/bookmark1.jpg" alt="" referrerpolicy="no-referrer" style="max-height: 100px;">
								{{/if}}
								<a class="single-product" href="/product-details/{{this.id}}/" @click="singleProduct" data-terendah="'{{this.harga_rendah}}'" data-tertinggi="'{{this.harga_tinggi}}'" data-id="'{{this.id}}'" data-gambar="'{{this.link_batik}}'" data-daerah="'{{this.daerah_batik}}'" data-makna="'{{this.makna_batik}}'" data-nama="'{{this.nama_batik}}'"><p>{{this.nama_batik}}</p></a>
								<h5>Rp. {{this.harga_tinggi.toLocaleString("en-US")}}</h5>
								<br>
							</div>
						</div>
						{{/each}}
					</div>
				</div>
			</div>
			<div class="product product-home new-product segments-bottom">
				<div class="container">
					<div class="section-title">
						<h3>Batik Terbaru</h3>
						<div class="wrap-more">
							<a href="/product-all/">Semuanya <i class="fa fa-angle-right"></i></a>
						</div>
					</div>
					<div class="row">
						{{#each data2}}
						<div class="col-50">
							<div class="content">
								{{#if this.link_batik}}
								<img src="{{this.link_batik}}" alt="" referrerpolicy="no-referrer" style="max-height: 100px;">
								{{else}}
								<img src="static/images/bookmark1.jpg" alt="" referrerpolicy="no-referrer" style="max-height: 100px;">
								{{/if}}
								<a class="single-product" href="/product-details/{{this.id}}/" @click="singleProduct" data-terendah="'{{this.harga_rendah}}'" data-tertinggi="'{{this.harga_tinggi}}'" data-id="'{{this.id}}'" data-gambar="'{{this.link_batik}}'" data-daerah="'{{this.daerah_batik}}'" data-makna="'{{this.makna_batik}}'" data-nama="'{{this.nama_batik}}'"><p>{{this.nama_batik}}</p></a>
								<h5>Rp. {{this.harga_tinggi.toLocaleString("en-US")}}</h5>
								<br>
							</div>
						</div>
						{{/each}}
					</div>
				</div>
			</div>
			<footer class="segments">
				<div class="container">
					<h1>MyBatik</h1>
					<p>MyBatik merupakan aplikasi yang berguna untuk mengetahui info tentang batik yang ada di Indonesia.</p>
					<ul>
						<li><a class="link external" target="_system" href="https://www.facebook.com/rizky.slankers.3386"><i class="fa fa-facebook"></i></a></li>
						<li><a class="link external" target="_system" href="https://twitter.com/RKarianata"><i class="fa fa-twitter"></i></a></li>
						<li><a class="link external" target="_system" href="https://www.youtube.com/channel/UCwhkJwsq6swJrerdP0tixJA/featured"><i class="fa fa-youtube"></i></a></li>
						<li><a class="link external" target="_system" href="https://www.instagram.com/rizkikarianata/?hl=id"><i class="fa fa-instagram"></i></a></li>
					</ul>
					<p>Hak Cipta &copy; 2021</p>
				</div>
			</footer>
		</div>
	</div>
</template>
<script>
	export default{
		mounted() {
			var $this = this;
			var app = this.$app;
			var $$ = this.$$;
			var self = this;
		},
		methods: {
			singleProduct: function(e) {
				var $this = this;
				var app = this.$app;
				var $$ = this.$$;
				var self = this;
				localStorage.setItem('terendah', $$(e.path[1]).data("terendah"));
				localStorage.setItem('tertinggi', $$(e.path[1]).data("tertinggi"));
				localStorage.setItem('id', $$(e.path[1]).data("id"));
				localStorage.setItem('gambar', $$(e.path[1]).data("gambar"));
				localStorage.setItem('daerah', $$(e.path[1]).data("daerah"));
				localStorage.setItem('makna', $$(e.path[1]).data("makna"));
				localStorage.setItem('nama', $$(e.path[1]).data("nama"));
				console.log(e);
			},
		},
		on: {
			pageInit: function () {
				var self = this;
				var $this = this;
				var app = this.$app;
				var $$ = this.$$;
				app.request.get('http://batikita.herokuapp.com/index.php/batik/popular', (response) => {
					var items = [];
					var dataJSON = new Array();
					dataJSON = JSON.parse(response);
					var item = dataJSON.hasil;
					for(var i = 0; i < 6; i++) {
						var tampil = item[i];
						var harga_rendah = tampil.harga_rendah;
						var harga_tinggi = tampil.harga_tinggi;
						var hitung_view = tampil.hitung_view;
						var id = tampil.id;
						var link_batik = tampil.link_batik;
						if(tampil.daerah_batik != null) {
							var daerah_batik = tampil.daerah_batik.replace(/['"()]/g, "");
						}else {
							var daerah_batik = "-";	
						}
						if(tampil.makna_batik != null) {
							var makna_batik = tampil.makna_batik.replace(/['"()]/g, "");
						}else {
							var makna_batik = "-";	
						}
						if(tampil.nama_batik != null) {
							var nama_batik = tampil.nama_batik.replace(/['"()]/g, "");
						}else {
							var nama_batik = "-";	
						}
						items.push({
							id: id,
							nama_batik: nama_batik,
							makna_batik: makna_batik,
							daerah_batik: daerah_batik,
							harga_rendah: harga_rendah,
							harga_tinggi: harga_tinggi,
							hitung_view: hitung_view,
							link_batik: link_batik
						});
					}
					console.log(items);
					self.$setState({
						data1: items
					});
				});
				app.request.get('http://batikita.herokuapp.com/index.php/batik/all', (response) => {
					var items = [];
					var dataJSON = new Array();
					dataJSON = JSON.parse(response);
					var item = dataJSON.hasil;
					for(var i = 0; i < 6; i++) {
						var tampil = item[i];
						var harga_rendah = tampil.harga_rendah;
						var harga_tinggi = tampil.harga_tinggi;
						var hitung_view = tampil.hitung_view;
						var id = tampil.id;
						var link_batik = tampil.link_batik;
						if(tampil.daerah_batik != null) {
							var daerah_batik = tampil.daerah_batik.replace(/['"()]/g, "");
						}else {
							var daerah_batik = "-";	
						}
						if(tampil.makna_batik != null) {
							var makna_batik = tampil.makna_batik.replace(/['"()]/g, "");
						}else {
							var makna_batik = "-";	
						}
						if(tampil.nama_batik != null) {
							var nama_batik = tampil.nama_batik.replace(/['"()]/g, "");
						}else {
							var nama_batik = "-";	
						}
						items.push({
							id: id,
							nama_batik: nama_batik,
							makna_batik: makna_batik,
							daerah_batik: daerah_batik,
							harga_rendah: harga_rendah,
							harga_tinggi: harga_tinggi,
							hitung_view: hitung_view,
							link_batik: link_batik
						});
					}
					console.log(dataJSON);
					self.$setState({
						data2: items
					});
				});
			},
		},
	}
</script>